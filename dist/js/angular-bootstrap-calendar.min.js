/**
 * angular-bootstrap-calendar - A pure AngularJS bootstrap themed responsive calendar that can display events and has views for year, month, week and day
 * @version v0.9.2
 * @link https://github.com/mattlewis92/angular-bootstrap-calendar
 * @license MIT
 */
!function(e,t){"use strict";t.module("mwl.calendar",[]),t.module("mwl.calendar").constant("moment",e.moment),t.module("mwl.calendar").service("calendarHelper",["moment","calendarConfig",function(e,t){function a(){return 1===e().startOf("week").day()}function n(t,a,n){var i=e(t).startOf(a),l=e(t).endOf(a);return n.filter(function(e){return r.eventIsInPeriod(e.starts_at,e.ends_at,i,l)})}var r=this;this.getWeekDayNames=function(){for(var a=[],n=0;7>n;)a.push(e().weekday(n++).format(t.dateFormats.weekDay));return a},this.eventIsInPeriod=function(t,a,n,r){return t=e(t),a=e(a),n=e(n),r=e(r),t.isAfter(n)&&t.isBefore(r)||a.isAfter(n)&&a.isBefore(r)||t.isBefore(n)&&a.isAfter(r)||t.isSame(n)||a.isSame(r)},this.getYearView=function(a,i){for(var l=[],o=n(i,"year",a),c=e(i).startOf("year"),d=0;12>d;){var s=c.clone(),u=s.clone().endOf("month");l.push({label:s.format(t.dateFormats.month),isToday:s.isSame(e().startOf("month")),events:o.filter(function(e){return r.eventIsInPeriod(e.starts_at,e.ends_at,s,u)}),date:s}),c.add(1,"month"),d++}return l},this.getMonthView=function(t,a){for(var i=n(a,"month",t),l=e(a).startOf("month"),o=l.clone().startOf("week"),c=e(a).endOf("month").endOf("week"),d=[],s=e().startOf("day");o.isBefore(c);){var u=o.month()===e(a).month(),f=[];u&&(f=i.filter(function(e){return r.eventIsInPeriod(e.starts_at,e.ends_at,o,o.clone().endOf("day"))})),d.push({label:o.date(),date:o.clone(),inMonth:u,isPast:s.isAfter(o),isToday:s.isSame(o),isFuture:s.isBefore(o),isWeekend:[0,6].indexOf(o.day())>-1,events:f}),o.add(1,"day")}return d},this.getWeekView=function(n,i){var l,o,c,d,s=a()?1:0,u=new Array(7),f=r.getWeekDayNames(),m=i.getDay();for(c=m;c>=0;c--)d=e(i).subtract(m-c,"days").add(s,"day").toDate(),u[c]={weekDay:f[c],day:e(d).format("D"),date:e(d).format(t.dateFormats.day),isPast:e(d).startOf("day").isBefore(e().startOf("day")),isToday:e(d).startOf("day").isSame(e().startOf("day")),isFuture:e(d).startOf("day").isAfter(e().startOf("day")),isWeekend:[0,6].indexOf(e(d).day())>-1},0===c?l=d:6===c&&(o=d);for(c=m+1;7>c;c++)d=e(i).add(c-m,"days").add(s,"day").toDate(),u[c]={weekDay:f[c],day:e(d).format("D"),date:e(d).format(t.dateFormats.day),isPast:e(d).startOf("day").isBefore(e().startOf("day")),isToday:e(d).startOf("day").isSame(e().startOf("day")),isFuture:e(d).startOf("day").isAfter(e().startOf("day")),isWeekend:[0,6].indexOf(e(d).day())>-1},0===c?l=d:6===c&&(o=d);o=e(o).endOf("day").toDate(),l=e(l).startOf("day").toDate();var v=n.filter(function(e){return r.eventIsInPeriod(e.starts_at,e.ends_at,l,o)}).map(function(t){var a,n,r=e(t.starts_at).startOf("day"),i=e(t.ends_at).startOf("day"),c=e(l).startOf("day"),d=e(o).startOf("day");return a=r.isBefore(c)||r.isSame(c)?0:r.diff(c,"days"),i.isAfter(d)&&(i=d),r.isBefore(c)&&(r=c),n=e(i).diff(r,"days")+1,t.daySpan=n,t.dayOffset=a,t});return{columns:u,events:v}},this.getDayView=function(t,a,i,l,o){var c=n(a,"day",t),d=e(a).startOf("day").add(i,"hours"),s=e(a).startOf("day").add(l,"hours"),u=(l-i+1)*o,f=o/60,m=[];return c.filter(function(t){return r.eventIsInPeriod(t.starts_at,t.ends_at,e(a).startOf("day").toDate(),e(a).endOf("day").toDate())}).map(function(t){if(t.top=e(t.starts_at).isBefore(d)?0:e(t.starts_at).startOf("minute").diff(d.startOf("minute"),"minutes")*f-2,e(t.ends_at).isAfter(s))t.height=u-t.top;else{var a=t.starts_at;e(t.starts_at).isBefore(d)&&(a=d.toDate()),t.height=e(t.ends_at).diff(a,"minutes")*f}return t.top-t.height>u&&(t.height=0),t.left=0,t}).filter(function(e){return e.height>0}).map(function(e){var t=!0;return m.forEach(function(a,n){var i=!0;a.forEach(function(t){(r.eventIsInPeriod(e.starts_at,e.ends_at,t.starts_at,t.ends_at)||r.eventIsInPeriod(t.starts_at,t.ends_at,e.starts_at,e.ends_at))&&(i=!1)}),i&&t&&(t=!1,e.left=150*n,m[n].push(e))}),t&&(e.left=150*m.length,m.push([e])),e})}}]),t.module("mwl.calendar").service("calendarDebounce",["$timeout",function(e){function t(t,a,n){var r;return function(){var i=this,l=arguments,o=function(){r=null,n||t.apply(i,l)},c=n&&!r;e.cancel(r),r=e(o,a),c&&t.apply(i,l)}}return t}]),t.module("mwl.calendar").provider("calendarConfig",function(){var e={hour:"ha",day:"D MMM",month:"MMMM",weekDay:"dddd"},a={day:"dddd D MMMM, YYYY",week:"Week {week} of {year}",month:"MMMM YYYY",year:"YYYY"},n=this;n.configureDateFormats=function(a){return t.extend(e,a),n},n.configureTitleFormats=function(e){return t.extend(a,e),n},n.$get=function(){return{dateFormats:e,titleFormats:a}}}),t.module("mwl.calendar").filter("truncateEventTitle",function(){return function(e,t,a){return e?e.length>=t&&e.length/20>a/30?e.substr(0,t)+"...":e:""}}),t.module("mwl.calendar").filter("eventCountBadgeTotal",function(){return function(e){return e.filter(function(e){return e.incrementsBadgeTotal!==!1}).length}}),t.module("mwl.calendar").filter("calendarLimitTo",function(){return function(e,a,n){return a=1/0===Math.abs(Number(a))?Number(a):parseInt(a),isNaN(a)?e:(t.isNumber(e)&&(e=e.toString()),t.isArray(e)||t.isString(e)?(n=!n||isNaN(n)?0:parseInt(n),n=0>n&&n>=-e.length?e.length+n:n,a>=0?e.slice(n,n+a):0===n?e.slice(a,e.length):e.slice(Math.max(0,n+a),n)):e)}}),t.module("mwl.calendar").directive("mwlCollapseFallback",["$injector",function(e){return e.has("collapseDirective")?{}:{restrict:"A",controller:["$scope","$attrs","$element",function(e,t,a){var n=e.$watch(t.mwlCollapseFallback,function(e){e?a.addClass("ng-hide"):a.removeClass("ng-hide")}),r=e.$on("$destroy",function(){r(),n()})}]}}]),t.module("mwl.calendar").directive("mwlCalendarYear",["moment",function(e){return{templateUrl:"src/templates/calendarYearView.html",restrict:"EA",require:"^mwlCalendar",scope:{events:"=calendarEvents",currentDay:"=calendarCurrentDay",eventClick:"=calendarEventClick",eventEditClick:"=calendarEditEventClick",eventDeleteClick:"=calendarDeleteEventClick",editEventHtml:"=calendarEditEventHtml",deleteEventHtml:"=calendarDeleteEventHtml",autoOpen:"=calendarAutoOpen",timespanClick:"=calendarTimespanClick"},controller:["$scope","$timeout","calendarHelper","eventCountBadgeTotalFilter","calendarDebounce",function(t,a,n,r,i){var l=this,o=!1;l.eventCountBadgeTotalFilter=r;var c=i(function(){l.view=n.getYearView(t.events,t.currentDay),t.autoOpen&&!o&&l.view.forEach(function(n){e(t.currentDay).startOf("month").isSame(n.date)&&(l.monthClicked(n,!0),a(function(){o=!1}))})},50);t.$watch("currentDay",c),t.$watch("events",c,!0),l.monthClicked=function(e,a){if(a||t.timespanClick({calendarDate:e.date.toDate()}),l.openEvents=e.events,l.openRowIndex=null,l.openEvents.length>0){var n=l.view.indexOf(e);l.openRowIndex=Math.floor(n/4)}},l.drillDown=function(a){var n=e(t.currentDay).clone().month(a.date.month()).toDate();t.timespanClick({calendarDate:n})!==!1&&l.calendarCtrl.changeView("month",n)}}],controllerAs:"vm",link:function(e,t,a,n){e.vm.calendarCtrl=n}}}]),t.module("mwl.calendar").directive("mwlCalendarWeek",function(){return{templateUrl:"src/templates/calendarWeekView.html",restrict:"EA",require:"^mwlCalendar",scope:{events:"=calendarEvents",currentDay:"=calendarCurrentDay",eventClick:"=calendarEventClick",timespanClick:"=calendarTimespanClick"},controller:["$scope","moment","calendarHelper","calendarDebounce",function(e,t,a,n){var r=n(function(){e.view=a.getWeekView(e.events,e.currentDay)},50);e.drillDown=function(a){var n=t(e.currentDay).clone().date(a).toDate();e.timespanClick({calendarDate:n})!==!1&&e.calendarCtrl.changeView("day",n)},e.$watch("currentDay",r),e.$watch("events",r,!0)}],link:function(e,t,a,n){e.calendarCtrl=n}}}),t.module("mwl.calendar").directive("mwlCalendarSlideBox",function(){return{restrict:"EA",templateUrl:"src/templates/calendarSlideBox.html",replace:!0,controller:["$scope","$sce",function(e,t){var a=this;a.$sce=t;var n=e.$watch("isOpen",function(e){a.shouldCollapse=!e}),r=e.$on("$destroy",function(){r(),n()})}],controllerAs:"vm",require:["^?mwlCalendarMonth","^?mwlCalendarYear"],link:function(e,t,a,n){e.isMonthView=!!n[0],e.isYearView=!!n[1]},scope:{isOpen:"=",isMonthView:"=?",isYearView:"=?",events:"=",eventClick:"=",editEventHtml:"=",eventEditClick:"=",deleteEventHtml:"=",eventDeleteClick:"="}}}),t.module("mwl.calendar").directive("mwlCalendarMonth",function(){return{templateUrl:"src/templates/calendarMonthView.html",restrict:"EA",require:"^mwlCalendar",scope:{events:"=calendarEvents",currentDay:"=calendarCurrentDay",eventClick:"=calendarEventClick",eventEditClick:"=calendarEditEventClick",eventDeleteClick:"=calendarDeleteEventClick",editEventHtml:"=calendarEditEventHtml",deleteEventHtml:"=calendarDeleteEventHtml",autoOpen:"=calendarAutoOpen",timespanClick:"=calendarTimespanClick"},controller:["$scope","$timeout","moment","calendarHelper","eventCountBadgeTotalFilter","calendarDebounce",function(e,t,a,n,r,i){var l=this,o=!1;l.eventCountBadgeTotalFilter=r;var c=i(function(){l.view=n.getMonthView(e.events,e.currentDay);var r=Math.floor(l.view.length/7);l.monthOffsets=[];for(var i=0;r>i;i++)l.monthOffsets.push(7*i);e.autoOpen&&!o&&l.view.forEach(function(n){n.inMonth&&a(e.currentDay).startOf("day").isSame(n.date)&&(l.dayClicked(n,!0),t(function(){o=!1}))})},50);e.$watch("currentDay",c),e.$watch("events",c,!0),l.weekDays=n.getWeekDayNames(),l.dayClicked=function(t,a){if(a||e.timespanClick({calendarDate:t.date.toDate()}),l.view.forEach(function(e){e.isOpened=!1}),l.openEvents=t.events,l.openRowIndex=null,l.openEvents.length>0){var n=l.view.indexOf(t);l.openRowIndex=Math.floor(n/7),t.isOpened=!0}},l.drillDown=function(t){var n=a(e.currentDay).clone().date(t.date.date()).toDate();e.timespanClick({calendarDate:n})!==!1&&l.calendarCtrl.changeView("day",n)},l.highlightEvent=function(e,t){l.view.forEach(function(a){if(delete a.highlightClass,t){var n=a.events.indexOf(e)>-1;n&&(a.highlightClass="day-highlight dh-event-"+e.type)}})}}],controllerAs:"vm",link:function(e,t,a,n){e.vm.calendarCtrl=n}}}),t.module("mwl.calendar").directive("mwlCalendarDay",function(){return{templateUrl:"src/templates/calendarDayView.html",restrict:"EA",require:"^mwlCalendar",scope:{events:"=calendarEvents",currentDay:"=calendarCurrentDay",eventClick:"=calendarEventClick",eventLabel:"@calendarEventLabel",timeLabel:"@calendarTimeLabel",dayViewStart:"@calendarDayViewStart",dayViewEnd:"@calendarDayViewEnd",dayViewSplit:"@calendarDayViewSplit"},controller:["$scope","moment","calendarHelper","calendarConfig","calendarDebounce",function(e,t,a,n,r){var i=t(e.dayViewStart||"00:00","HH:mm"),l=t(e.dayViewEnd||"23:00","HH:mm");e.dayViewSplit=parseInt(e.dayViewSplit),e.dayHeight=60/e.dayViewSplit*30,e.days=[];for(var o=t(i),c=0;c<=l.diff(i,"hours");c++)e.days.push({label:o.format(n.dateFormats.hour)}),o.add(1,"hour");var d=r(function(){e.view=a.getDayView(e.events,e.currentDay,i.hours(),l.hours(),e.dayHeight)},50);e.$watch("currentDay",d),e.$watch("events",d,!0)}]}}),t.module("mwl.calendar").directive("mwlCalendar",function(){return{templateUrl:"src/templates/calendar.html",restrict:"EA",scope:{events:"=calendarEvents",view:"=calendarView",currentDay:"=calendarCurrentDay",control:"=calendarControl",eventClick:"&calendarEventClick",eventEditClick:"&calendarEditEventClick",eventDeleteClick:"&calendarDeleteEventClick",editEventHtml:"=calendarEditEventHtml",deleteEventHtml:"=calendarDeleteEventHtml",autoOpen:"=calendarAutoOpen",useIsoWeek:"=calendarUseIsoWeek",eventLabel:"@calendarEventLabel",timeLabel:"@calendarTimeLabel",dayViewStart:"@calendarDayViewStart",dayViewEnd:"@calendarDayViewEnd",weekTitleLabel:"@calendarWeekTitleLabel",timespanClick:"&calendarTimespanClick",dayViewSplit:"@calendarDayViewSplit"},controller:["$scope","$timeout","moment","calendarConfig",function(e,a,n,r){var i=this,l=e.weekTitleLabel||r.titleFormats.week;this.titleFunctions={day:function(e){return n(e).format(r.titleFormats.day)},week:function(e){return l.replace("{week}",n(e).week()).replace("{year}",n(e).format("YYYY"))},month:function(e){return n(e).format(r.titleFormats.month)},year:function(e){return n(e).format(r.titleFormats.year)}},this.changeView=function(t,a){e.view=t,e.currentDay=a},e.control=e.control||{},e.control.prev=function(){e.currentDay=n(e.currentDay).subtract(1,e.view).toDate()},e.control.next=function(){e.currentDay=n(e.currentDay).add(1,e.view).toDate()},e.control.getTitle=function(){return i.titleFunctions[e.view]?i.titleFunctions[e.view](e.currentDay):""};var o=!0,c=e.$watch(function(){return n.locale()},function(r){if(e.useIsoWeek===!0&&n.locale(r,{week:{dow:1}}),o)return void(o=!1);var i=t.copy(e.view);e.view="redraw",a(function(){e.view=i})}),d=e.$on("$destroy",function(){d(),c()})}]}})}(window,angular);
//# sourceMappingURL=angular-bootstrap-calendar.min.js.map