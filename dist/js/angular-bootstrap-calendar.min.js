"use strict";angular.module("mwl.calendar",["ui.bootstrap"]),angular.module("mwl.calendar").run(["$templateCache",function(a){a.put("templates/day.html",'<div class="cal-day-box"><div class="row-fluid clearfix cal-row-head"><div class="span1 col-xs-1 cal-cell">Time</div><div class="span11 col-xs-11 cal-cell">Events</div></div><div class="cal-day-panel" style="height: 960px;"><div class="cal-day-panel-hour"><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>06:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>06:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>07:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>07:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>08:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>08:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>09:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>09:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>10:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>10:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>11:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>11:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>12:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>12:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>13:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>13:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>14:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>14:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>15:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>15:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>16:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>16:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>17:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>17:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>18:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>18:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>19:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>19:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>20:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>20:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>21:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>21:30</b></div><div class="span11 col-xs-11"></div></div></div></div><div class="pull-left day-event day-highlight dh-event-{{ event.type }}" ng-repeat="event in view" ng-style="{\'margin-top\': event.marginTop + \'px\', height: event.height + \'px\'}"><span class="cal-hours">{{ event.starts_at | date:\'d MMM HH:mm\' }} - {{ event.ends_at | date:\'d MMM HH:mm\' }}</span><br><a href="javascript:;" class="event-item" ng-click="eventClick({$event: event})">{{ event.title }}</a></div></div></div>'),a.put("templates/main.html",'<div class="cal-context" style="width: 100%;"><mwl-calendar-year calendar-events="events" calendar-current-day="currentDay" calendar-control="subControls.year" calendar-event-click="eventClickHandler($event)" ng-show="view == \'year\'"></mwl-calendar-year><mwl-calendar-month calendar-events="events" calendar-current-day="currentDay" calendar-control="subControls.month" calendar-event-click="eventClickHandler($event)" ng-show="view == \'month\'"></mwl-calendar-month><mwl-calendar-week calendar-events="events" calendar-current-day="currentDay" calendar-control="subControls.week" calendar-event-click="eventClickHandler($event)" ng-show="view == \'week\'"></mwl-calendar-week><mwl-calendar-day calendar-events="events" calendar-current-day="currentDay" calendar-control="subControls.day" calendar-event-click="eventClickHandler($event)" ng-show="view == \'day\'"></mwl-calendar-day></div>'),a.put("templates/month.html",'<div class="cal-row-fluid cal-row-head"><div class="cal-cell1" ng-repeat="day in weekDays">{{ day }}</div></div><div class="cal-month-box"><div ng-repeat="week in view"><div class="cal-row-fluid cal-before-eventlist"><div class="cal-cell1 cal-cell" ng-repeat="day in week track by $index" ng-click="dayClicked($parent.$index, $index)" ng-class="{pointer: day.events.length > 0}"><div class="cal-month-day" ng-class="{\'cal-day-outmonth\': !day.inMonth, \'cal-day-inmonth\': day.inMonth, \'cal-day-weekend\': $index == 5 || $index == 6}"><span class="pull-right" data-cal-date="">{{ day.label }}</span><div class="cal-day-tick" ng-show="day.isOpened"><i class="icon-chevron-down glyphicon glyphicon-chevron-down"></i></div><div class="events-list" ng-show="day.events.length > 0"><a href="javascript:;" ng-click="eventClick({$event: event})" ng-repeat="event in day.events" class="pull-left event event-{{ event.type }}" tooltip-append-to-body="true" tooltip="{{ event.title }}"></a></div></div></div></div><div class="cal-slide-box" ng-show="week.isOpened"><div class="cal-slide-content cal-event-list"><ul class="unstyled list-unstyled"><li ng-repeat="event in openEvents"><span class="pull-left event event-{{ event.type }}"></span> &nbsp; <a href="javascript:;" class="event-item" ng-click="eventClick({$event: event})">{{ event.title }}</a></li></ul></div></div></div></div>'),a.put("templates/week.html",'<div class="cal-week-box"><div class="cal-row-fluid cal-row-head"><div class="cal-cell1" ng-repeat="column in view.columns" ng-class="{\'cal-day-weekend\': $index > 4}">{{ column.weekDay }}<br><small><span data-cal-date="2013-03-10">{{ column.date }}</span></small></div></div><hr><div class="cal-row-fluid" ng-repeat="event in view.events"><div class="cal-cell{{ event.daySpan }} cal-offset{{ event.dayOffset }} day-highlight dh-event-{{ event.type }}" data-event-class=""><a href="javascript:;" ng-click="eventClick({$event: event})" class="cal-event-week">{{ event.title }}</a></div></div></div>'),a.put("templates/year.html",'<div class="cal-year-box"><div ng-repeat="year in view"><div class="row cal-before-eventlist"><div class="span3 col-md-3 col-xs-6 cal-cell" ng-repeat="month in year" ng-click="monthClicked($parent.$index, $index)" ng-class="{pointer: month.events.length > 0}"><span class="pull-right" data-cal-date="">{{ month.label }}</span> <small class="cal-events-num badge badge-important pull-left" ng-show="month.events.length > 0">{{ month.events.length }}</small><div class="cal-day-tick" ng-show="month.isOpened"><i class="icon-chevron-down glyphicon glyphicon-chevron-down"></i></div></div></div><div class="cal-slide-box" ng-show="year.isOpened"><span class="cal-slide-tick"></span><div class="cal-slide-content"><ul class="unstyled list-unstyled"><li ng-repeat="event in openEvents"><span class="pull-left event" ng-class="\'event-\' + event.type"></span> &nbsp; <a href="javascript:;" class="event-item" ng-click="eventClick({$event: event})">{{ event.title }}</a></li></ul></div></div></div></div>')}]),angular.module("mwl.calendar").constant("moment",window.moment),angular.module("mwl.calendar").service("calendarHelper",["$filter","moment",function(a,e){var l=this;this.getMonthNames=function(e){for(var l=e?"MMM":"MMMM",s=[],n=0;11>=n;n++)s.push(a("date")(new Date(2014,n),l));return s},this.getWeekDayNames=function(e){for(var l=e?"EEE":"EEEE",s=[],n=0;6>=n;n++)s.push(a("date")(new Date(2014,8,22+n),l));return s},this.eventIsInPeriod=function(a,l,s,n){return e(a).isAfter(e(s))&&e(a).isBefore(e(n))||e(l).isAfter(e(s))&&e(l).isBefore(e(n))||e(a).isBefore(e(s))&&e(l).isAfter(e(n))},this.getYearView=function(a,s){for(var n=[],t=l.getMonthNames(),d=0;3>d;d++){for(var i=[],c=0;4>c;c++){var r=12-t.length;i.push({label:t.shift(),events:a.filter(function(a){var n=new Date(e(s).format("YYYY"),r,1),t=e(n).add(1,"month").subtract(1,"second").toDate();return l.eventIsInPeriod(a.starts_at,a.ends_at,n,t)})})}n.push(i)}return n},this.getMonthView=function(a,s){function n(){var a=t.day()-1;return 0>a&&(a=6),a}for(var t=e(s).startOf("month"),d=e(s).endOf("month").date(),i=[],c=new Array(7),r=1;d>=r;r++){if(1==r)for(var v=n(t),o=t.clone();v>0;)v--,o=o.subtract(1,"day"),c[v]={label:o.date(),inMonth:!1,events:[]};if(c[n(t)]={label:t.date(),inMonth:!0,events:a.filter(function(a){return l.eventIsInPeriod(a.starts_at,a.ends_at,t.clone().startOf("day"),t.clone().endOf("day"))})},r==d)for(var v=n(t),u=t.clone();6>v;)v++,u=u.add(1,"day"),c[v]={label:u.date(),inMonth:!1,events:[]};(6===n(t)||r==d)&&(i.push(c),c=new Array(7)),t=t.add(1,"day")}return i},this.getWeekView=function(s,n){for(var t,d,i=new Array(7),c=l.getWeekDayNames(),r=n.getDay(),v=r;v>=0;v--){var o=e(n).subtract(r-v,"days").add(1,"day").toDate();i[v]={weekDay:c[v],date:a("date")(o,"d MMM")},0==v?t=o:6==v&&(d=o)}for(var v=r+1;7>v;v++){var o=e(n).add(v-r,"days").add(1,"day").toDate();i[v]={weekDay:c[v],date:a("date")(o,"d MMM")},0==v?t=o:6==v&&(d=o)}d=e(d).add(1,"day").subtract(1,"second").toDate();var u=s.filter(function(a){return l.eventIsInPeriod(a.starts_at,a.ends_at,t,d)}).map(function(a){var l=e(a.ends_at).diff(e(a.starts_at),"days")+1;l>7&&(l=7,e(a.ends_at).diff(e(d),"days")<0&&(l+=e(a.ends_at).diff(e(d),"days")+1));var s=e(a.starts_at).diff(e(t),"days");return 0>s&&(s=0),s>6&&(s=6),l-s>0&&(l-=s),a.daySpan=l,a.dayOffset=s,a});return{columns:i,events:u}},this.getDayView=function(a,s){var n=e(s).startOf("day").add(6,"hours"),t=e(s).startOf("day").add(22,"hours"),d=960;return a.filter(function(a){return l.eventIsInPeriod(a.starts_at,a.ends_at,e(s).startOf("day").toDate(),e(s).endOf("day").toDate())}).map(function(a){if(a.marginTop=e(a.starts_at).isBefore(n)?"0":e(a.starts_at).diff(n,"minutes"),e(a.ends_at).isAfter(t))a.height=d-a.marginTop;else{var l=a.starts_at;e(a.starts_at).isBefore(n)&&(l=n.toDate()),a.height=e(a.ends_at).diff(l,"minutes")}return a.marginTop-a.height>d&&(a.height=0),a}).filter(function(a){return a.height>0})},this.toggleEventBreakdown=function(a,e,l){var s=[];if(a[e][l].events.length>0){var n=a[e][l].isOpened;a=a.map(function(a){return a.isOpened=!1,a.map(function(a){return a.isOpened=!1,a})}),a[e][l].isOpened=!n,a[e].isOpened=!n,s=a[e][l].events}return{view:a,openEvents:s}}}]),angular.module("mwl.calendar").directive("mwlCalendarYear",["calendarHelper","moment",function(a,e){return{templateUrl:"templates/year.html",restrict:"EA",scope:{events:"=calendarEvents",currentDay:"=calendarCurrentDay",control:"=calendarControl",eventClick:"&calendarEventClick"},link:function(l){l.control=l.control||{},l.control.getTitle=function(){return e(l.currentDay).format("YYYY")},l.control.updateView=function(){l.view=a.getYearView(l.events,l.currentDay)},l.monthClicked=function(e,s){var n=a.toggleEventBreakdown(l.view,e,s);l.view=n.view,l.openEvents=n.openEvents}}}}]),angular.module("mwl.calendar").directive("mwlCalendarWeek",["moment","calendarHelper",function(a,e){return{templateUrl:"templates/week.html",restrict:"EA",scope:{events:"=calendarEvents",currentDay:"=calendarCurrentDay",control:"=calendarControl",eventClick:"&calendarEventClick"},link:function(l){l.control=l.control||{},l.control.getTitle=function(){return"Week "+a(l.currentDay).week()+" of "+a(l.currentDay).format("YYYY")},l.control.updateView=function(){l.view=e.getWeekView(l.events,l.currentDay)}}}}]),angular.module("mwl.calendar").directive("mwlCalendarMonth",["calendarHelper",function(a){return{templateUrl:"templates/month.html",restrict:"EA",scope:{events:"=calendarEvents",currentDay:"=calendarCurrentDay",control:"=calendarControl",eventClick:"&calendarEventClick"},link:function(e){e.control=e.control||{},e.control.getTitle=function(){return moment(e.currentDay).format("MMMM YYYY")},e.control.updateView=function(){e.view=a.getMonthView(e.events,e.currentDay)},e.weekDays=a.getWeekDayNames(),e.dayClicked=function(l,s){var n=a.toggleEventBreakdown(e.view,l,s);e.view=n.view,e.openEvents=n.openEvents}}}}]),angular.module("mwl.calendar").directive("mwlCalendarDay",["calendarHelper",function(a){return{templateUrl:"templates/day.html",restrict:"EA",scope:{events:"=calendarEvents",currentDay:"=calendarCurrentDay",control:"=calendarControl",eventClick:"&calendarEventClick"},link:function(e){e.control=e.control||{},e.control.getTitle=function(){return moment(e.currentDay).format("dddd DD MMMM, YYYY")},e.control.updateView=function(){e.view=a.getDayView(e.events,e.currentDay)}}}}]),angular.module("mwl.calendar").directive("mwlCalendar",["$timeout","moment",function(a,e){return{templateUrl:"templates/main.html",restrict:"EA",scope:{events:"=calendarEvents",view:"=calendarView",currentDay:"=calendarCurrentDay",control:"=calendarControl",title:"=calendarTitle",eventClick:"&calendarEventClick"},link:function(l){function s(){a(function(){l.subControls[l.view]?(l.title=l.subControls[l.view].getTitle(),l.subControls[l.view].updateView()):s()})}l.subControls={},l.control=l.control||{},l.control.prev=function(){l.currentDay=e(l.currentDay).subtract(1,l.view).toDate()},l.control.next=function(){l.currentDay=e(l.currentDay).add(1,l.view).toDate()},l.eventClickHandler=function(a){l.eventClick({$event:a})},a(function(){l.$watch("view",s),l.$watch("currentDay",s),l.$watch("events",s)})}}}]);
//# sourceMappingURL=angular-bootstrap-calendar.min.js.map