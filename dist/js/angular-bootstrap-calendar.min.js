"use strict";angular.module("mwl.calendar",["ui.bootstrap"]),angular.module("mwl.calendar").run(["$templateCache",function(e){e.put("templates/day.html",'<div class="cal-day-box"><div class="row-fluid clearfix cal-row-head"><div class="span1 col-xs-1 cal-cell">Time</div><div class="span11 col-xs-11 cal-cell">Events</div></div><div class="cal-day-panel" style="height: 960px;"><div class="cal-day-panel-hour"><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>06:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>06:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>07:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>07:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>08:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>08:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>09:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>09:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>10:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>10:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>11:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>11:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>12:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>12:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>13:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>13:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>14:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>14:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>15:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>15:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>16:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>16:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>17:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>17:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>18:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>18:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>19:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>19:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>20:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>20:30</b></div><div class="span11 col-xs-11"></div></div></div><div class="cal-day-hour"><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>21:00</b></div><div class="span11 col-xs-11"></div></div><div class="row-fluid cal-day-hour-part"><div class="span1 col-xs-1"><b>21:30</b></div><div class="span11 col-xs-11"></div></div></div></div><div class="pull-left day-event day-highlight dh-event-{{ event.type }}" ng-repeat="event in view track by $index" ng-style="{\'margin-top\': event.marginTop + \'px\', height: event.height + \'px\'}"><span class="cal-hours">{{ event.starts_at | date:\'d MMM HH:mm\' }} - {{ event.ends_at | date:\'d MMM HH:mm\' }}</span><br><a href="javascript:;" class="event-item" ng-click="eventClick({$event: event})">{{ event.title }}</a></div></div></div>'),e.put("templates/main.html",'<div class="cal-context" style="width: 100%;"><mwl-calendar-year calendar-events="events" calendar-current-day="currentDay" calendar-event-click="eventClick" calendar-edit-event-click="eventEditClick" calendar-delete-event-click="eventDeleteClick" calendar-edit-event-html="editEventHtml" calendar-delete-event-html="deleteEventHtml" ng-if="view == \'year\'"></mwl-calendar-year><mwl-calendar-month calendar-events="events" calendar-current-day="currentDay" calendar-event-click="eventClick" calendar-edit-event-click="eventEditClick" calendar-delete-event-click="eventDeleteClick" calendar-edit-event-html="editEventHtml" calendar-delete-event-html="deleteEventHtml" ng-if="view == \'month\'"></mwl-calendar-month><mwl-calendar-week calendar-events="events" calendar-current-day="currentDay" calendar-event-click="eventClick" ng-if="view == \'week\'"></mwl-calendar-week><mwl-calendar-day calendar-events="events" calendar-current-day="currentDay" calendar-event-click="eventClick" ng-if="view == \'day\'"></mwl-calendar-day></div>'),e.put("templates/month.html",'<div class="cal-row-fluid cal-row-head"><div class="cal-cell1" ng-repeat="day in weekDays">{{ day }}</div></div><div class="cal-month-box"><div ng-repeat="week in view track by $index"><div class="cal-row-fluid cal-before-eventlist"><div class="cal-cell1 cal-cell {{ day.highlightClass }}" ng-repeat="day in week track by $index" ng-click="dayClicked($parent.$index, $index)" ng-class="{pointer: day.events.length > 0}"><div class="cal-month-day" ng-class="{\'cal-day-outmonth\': !day.inMonth, \'cal-day-inmonth\': day.inMonth, \'cal-day-weekend\': $index == 5 || $index == 6}"><span class="pull-right" data-cal-date="">{{ day.label }}</span><div class="cal-day-tick" ng-show="day.isOpened"><i class="icon-chevron-down glyphicon glyphicon-chevron-down"></i></div><div class="events-list" ng-show="day.events.length > 0"><a href="javascript:;" ng-click="eventClick({$event: event})" ng-repeat="event in day.events track by $index" class="pull-left event event-{{ event.type }}" ng-mouseenter="highlightEvent(event, true)" ng-mouseleave="highlightEvent(event, false)" tooltip-append-to-body="true" tooltip="{{ event.title }}"></a></div></div></div></div><div class="cal-slide-box" collapse="!week.isOpened"><div class="cal-slide-content cal-event-list"><ul class="unstyled list-unstyled"><li ng-repeat="event in openEvents track by $index"><span class="pull-left event event-{{ event.type }}"></span> &nbsp; <a href="javascript:;" class="event-item" ng-click="eventClick({$event: event})">{{ event.title }}</a> <a href="javascript:;" class="event-item-edit" ng-if="editEventHtml" ng-bind-html="$sce.trustAsHtml(editEventHtml)" ng-click="eventEditClick({$event: event})"></a> <a href="javascript:;" class="event-item-delete" ng-if="deleteEventHtml" ng-bind-html="$sce.trustAsHtml(deleteEventHtml)" ng-click="eventDeleteClick({$event: event})"></a></li></ul></div></div></div></div>'),e.put("templates/week.html",'<div class="cal-week-box"><div class="cal-row-fluid cal-row-head"><div class="cal-cell1" ng-repeat="column in view.columns track by $index" ng-class="{\'cal-day-weekend\': $index > 4}">{{ column.weekDay }}<br><small><span data-cal-date="2013-03-10">{{ column.date }}</span></small></div></div><hr><div class="cal-row-fluid" ng-repeat="event in view.events track by $index"><div class="cal-cell{{ event.daySpan }} cal-offset{{ event.dayOffset }} day-highlight dh-event-{{ event.type }}" data-event-class=""><a href="javascript:;" ng-click="eventClick({$event: event})" class="cal-event-week">{{ event.title }}</a></div></div></div>'),e.put("templates/year.html",'<div class="cal-year-box"><div ng-repeat="year in view track by $index"><div class="row cal-before-eventlist"><div class="span3 col-md-3 col-xs-6 cal-cell" ng-repeat="month in year track by $index" ng-click="monthClicked($parent.$index, $index)" ng-class="{pointer: month.events.length > 0}"><span class="pull-right" data-cal-date="">{{ month.label }}</span> <small class="cal-events-num badge badge-important pull-left" ng-show="month.events.length > 0">{{ month.events.length }}</small><div class="cal-day-tick" ng-show="month.isOpened"><i class="icon-chevron-down glyphicon glyphicon-chevron-down"></i></div></div></div><div class="cal-slide-box" collapse="!year.isOpened"><span class="cal-slide-tick"></span><div class="cal-slide-content"><ul class="unstyled list-unstyled"><li ng-repeat="event in openEvents track by $index"><span class="pull-left event" ng-class="\'event-\' + event.type"></span> &nbsp; <a href="javascript:;" class="event-item" ng-click="eventClick({$event: event})">{{ event.title }}</a> <a href="javascript:;" class="event-item-edit" ng-if="editEventHtml" ng-bind-html="$sce.trustAsHtml(editEventHtml)" ng-click="eventEditClick({$event: event})"></a> <a href="javascript:;" class="event-item-delete" ng-if="deleteEventHtml" ng-bind-html="$sce.trustAsHtml(deleteEventHtml)" ng-click="eventDeleteClick({$event: event})"></a></li></ul></div></div></div></div>')}]),angular.module("mwl.calendar").constant("moment",window.moment),angular.module("mwl.calendar").service("calendarHelper",["$filter","moment",function(e,a){var t=this;this.getMonthNames=function(a){for(var t=a?"MMM":"MMMM",l=[],n=0;11>=n;n++)l.push(e("date")(new Date(2014,n),t));return l},this.getWeekDayNames=function(a){for(var t=a?"EEE":"EEEE",l=[],n=0;6>=n;n++)l.push(e("date")(new Date(2014,8,22+n),t));return l},this.eventIsInPeriod=function(e,t,l,n){return a(e).isAfter(a(l))&&a(e).isBefore(a(n))||a(t).isAfter(a(l))&&a(t).isBefore(a(n))||a(e).isBefore(a(l))&&a(t).isAfter(a(n))},this.getYearView=function(e,l){for(var n=[],s=t.getMonthNames(),i=0;3>i;i++){for(var d=[],c=0;4>c;c++){var v=12-s.length;d.push({label:s.shift(),events:e.filter(function(e){var n=new Date(a(l).format("YYYY"),v,1),s=a(n).add(1,"month").subtract(1,"second").toDate();return t.eventIsInPeriod(e.starts_at,e.ends_at,n,s)})})}n.push(d)}return n},this.getMonthView=function(e,l){function n(){var e=s.day()-1;return 0>e&&(e=6),e}for(var s=a(l).startOf("month"),i=a(l).endOf("month").date(),d=[],c=new Array(7),v=e.map(function(e,a){return e.$id=a,e}),r=1;i>=r;r++){if(1==r)for(var o=n(s),u=s.clone();o>0;)o--,u=u.subtract(1,"day"),c[o]={label:u.date(),inMonth:!1,events:[]};if(c[n(s)]={label:s.date(),inMonth:!0,events:v.filter(function(e){return t.eventIsInPeriod(e.starts_at,e.ends_at,s.clone().startOf("day"),s.clone().endOf("day"))})},r==i)for(var o=n(s),p=s.clone();6>o;)o++,p=p.add(1,"day"),c[o]={label:p.date(),inMonth:!1,events:[]};(6===n(s)||r==i)&&(d.push(c),c=new Array(7)),s=s.add(1,"day")}return d},this.getWeekView=function(l,n){for(var s,i,d=new Array(7),c=t.getWeekDayNames(),v=n.getDay(),r=v;r>=0;r--){var o=a(n).subtract(v-r,"days").add(1,"day").toDate();d[r]={weekDay:c[r],date:e("date")(o,"d MMM")},0==r?s=o:6==r&&(i=o)}for(var r=v+1;7>r;r++){var o=a(n).add(r-v,"days").add(1,"day").toDate();d[r]={weekDay:c[r],date:e("date")(o,"d MMM")},0==r?s=o:6==r&&(i=o)}i=a(i).add(1,"day").subtract(1,"second").toDate();var u=l.filter(function(e){return t.eventIsInPeriod(e.starts_at,e.ends_at,s,i)}).map(function(e){var t=a(e.ends_at).diff(a(e.starts_at),"days")+1;t>7&&(t=7,a(e.ends_at).diff(a(i),"days")<0&&(t+=a(e.ends_at).diff(a(i),"days")+1));var l=a(e.starts_at).diff(a(s),"days");return 0>l&&(l=0),l>6&&(l=6),t-l>0&&(t-=l),e.daySpan=t,e.dayOffset=l,e});return{columns:d,events:u}},this.getDayView=function(e,l){var n=a(l).startOf("day").add(6,"hours"),s=a(l).startOf("day").add(22,"hours"),i=960;return e.filter(function(e){return t.eventIsInPeriod(e.starts_at,e.ends_at,a(l).startOf("day").toDate(),a(l).endOf("day").toDate())}).map(function(e){if(e.marginTop=a(e.starts_at).isBefore(n)?"0":a(e.starts_at).diff(n,"minutes"),a(e.ends_at).isAfter(s))e.height=i-e.marginTop;else{var t=e.starts_at;a(e.starts_at).isBefore(n)&&(t=n.toDate()),e.height=a(e.ends_at).diff(t,"minutes")}return e.marginTop-e.height>i&&(e.height=0),e}).filter(function(e){return e.height>0})},this.toggleEventBreakdown=function(e,a,t){var l=[];if(e[a][t].events.length>0){var n=e[a][t].isOpened;e=e.map(function(e){return e.isOpened=!1,e.map(function(e){return e.isOpened=!1,e})}),e[a][t].isOpened=!n,e[a].isOpened=!n,l=e[a][t].events}return{view:e,openEvents:l}}}]),angular.module("mwl.calendar").directive("mwlCalendarYear",["$sce","calendarHelper","moment",function(e,a,t){return{templateUrl:"templates/year.html",restrict:"EA",require:"^mwlCalendar",scope:{events:"=calendarEvents",currentDay:"=calendarCurrentDay",eventClick:"=calendarEventClick",eventEditClick:"=calendarEditEventClick",eventDeleteClick:"=calendarDeleteEventClick",editEventHtml:"=calendarEditEventHtml",deleteEventHtml:"=calendarDeleteEventHtml"},link:function(l,n,s,i){function d(){l.view=a.getYearView(l.events,l.currentDay)}l.$sce=e,i.titleFunctions.year=function(e){return t(e).format("YYYY")},l.$watch("currentDay",d),l.$watch("events",d,!0),l.monthClicked=function(e,t){var n=a.toggleEventBreakdown(l.view,e,t);l.view=n.view,l.openEvents=n.openEvents}}}}]),angular.module("mwl.calendar").directive("mwlCalendarWeek",["moment","calendarHelper",function(e,a){return{templateUrl:"templates/week.html",restrict:"EA",require:"^mwlCalendar",scope:{events:"=calendarEvents",currentDay:"=calendarCurrentDay",eventClick:"=calendarEventClick"},link:function(t,l,n,s){function i(){t.view=a.getWeekView(t.events,t.currentDay)}s.titleFunctions.week=function(a){return"Week "+e(a).week()+" of "+e(a).format("YYYY")},t.$watch("currentDay",i),t.$watch("events",i,!0)}}}]),angular.module("mwl.calendar").directive("mwlCalendarMonth",["$sce","calendarHelper",function(e,a){return{templateUrl:"templates/month.html",restrict:"EA",require:"^mwlCalendar",scope:{events:"=calendarEvents",currentDay:"=calendarCurrentDay",eventClick:"=calendarEventClick",eventEditClick:"=calendarEditEventClick",eventDeleteClick:"=calendarDeleteEventClick",editEventHtml:"=calendarEditEventHtml",deleteEventHtml:"=calendarDeleteEventHtml"},link:function(t,l,n,s){function i(){console.log("VIEW UPDATED"),t.view=a.getMonthView(t.events,t.currentDay)}t.$sce=e,s.titleFunctions.month=function(e){return moment(e).format("MMMM YYYY")},t.$watch("currentDay",i),t.$watch("events",i,!0),t.weekDays=a.getWeekDayNames(),t.dayClicked=function(e,l){var n=a.toggleEventBreakdown(t.view,e,l);t.view=n.view,t.openEvents=n.openEvents},t.highlightEvent=function(e,a){t.view=t.view.map(function(t){return t.map(function(t){if(delete t.highlightClass,a){var l=t.events.filter(function(a){return a.$id==e.$id}).length>0;l&&(t.highlightClass="day-highlight dh-event-"+e.type)}return t})})}}}}]),angular.module("mwl.calendar").directive("mwlCalendarDay",["calendarHelper",function(e){return{templateUrl:"templates/day.html",restrict:"EA",require:"^mwlCalendar",scope:{events:"=calendarEvents",currentDay:"=calendarCurrentDay",eventClick:"=calendarEventClick"},link:function(a,t,l,n){function s(){a.view=e.getDayView(a.events,a.currentDay)}n.titleFunctions.day=function(e){return moment(e).format("dddd DD MMMM, YYYY")},a.$watch("currentDay",s),a.$watch("events",s,!0)}}}]),angular.module("mwl.calendar").directive("mwlCalendar",["moment",function(e){return{templateUrl:"templates/main.html",restrict:"EA",scope:{events:"=calendarEvents",view:"=calendarView",currentDay:"=calendarCurrentDay",control:"=calendarControl",eventClick:"&calendarEventClick",eventEditClick:"&calendarEditEventClick",eventDeleteClick:"&calendarDeleteEventClick",editEventHtml:"=calendarEditEventHtml",deleteEventHtml:"=calendarDeleteEventHtml"},controller:["$scope",function(a){var t=this;this.titleFunctions={},a.control=a.control||{},a.control.prev=function(){a.currentDay=e(a.currentDay).subtract(1,a.view).toDate()},a.control.next=function(){a.currentDay=e(a.currentDay).add(1,a.view).toDate()},a.control.getTitle=function(){return t.titleFunctions[a.view]?t.titleFunctions[a.view](a.currentDay):""}}]}}]);
//# sourceMappingURL=angular-bootstrap-calendar.min.js.map